<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-KyZXEAg3QhqLMpG8r+8fhAXLRk2vvoC2f3B09zVXn8CA5QIVfZOJ3BCsw2P0p/We"
      crossorigin="anonymous"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css"
    />
    <title>연락처 관리</title>
  </head>

  <body style="width: 700px" class="mx-auto">
    <h2 class="text-center my-3">연락처 관리✏</h2>

    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-U1DAWAznBHeqEIlVSCgzq+c9gqGAJn5c/t99JyeKa9xxaYpSvHU5awsuZVVFIhvj"
      crossorigin="anonymous"
    ></script>

    <form
      id="form-input"
      class="form-control flex text-center"
      onsubmit="return false"
      style="border-color: white"
    >
      <input
        id="txt-name"
        type="text"
        class="me-1 mt-4"
        placeholder="이름"
        style="width: 190px"
      />
      <input
        id="txt-contact"
        type="tel"
        class="me-1 mt-4"
        placeholder="전화번호"
        style="width: 190px"
      />
      <input
        id="txt-email"
        type="email"
        class="me-2 mt-4"
        placeholder="이메일"
        style="width: 190px"
      />

      <button
        id="btn-add"
        type="button"
        class="btn btn-outline-primary text-nowrap btn-sm me-n1"
        onClick="addRow()"
      >
        추가
      </button>
    </form>

    <table id="table" class="table table-striped mt-5">
      <thead>
        <tr>
          <th>#</th>
          <th>이름</th>
          <th>전화번호</th>
          <th>이메일</th>
          <th>작업</th>
        </tr>
      </thead>
      <tbody id="tbody" class="tbody"></tbody>
      <!--
          <tfoot id="tfoot">
            <tr id="data-empty" class="text-center">
              <td colspan="5">데이터가 없습니다.</td>
            </tr>
          </tfoot>
-->
    </table>

    <script>
      /*Row 추가*/
      function addRow() {
        const txtName = document.getElementById("txt-name").value;
        const txtContact = document.getElementById("txt-contact").value;
        const txtEmail = document.getElementById("txt-email").value;
        const formInput = document.querySelector("#form-input");
        formInput.reset();
        const newRow = tbody.insertRow(tbody.rows.length - 2 / 0);

        //-----------------------------------------
        /*
        const btnAdd = document.querySelector("#btn-add");
        btnAdd.addEventListener("click", add);

        txtName.addEventListener("keyup", (event) => {
          if (event.keycode == 13) {
            txtName.blur();
            add(event);
          }
        });
*/
        // ------------------------------------------------

        if (!txtName || !txtContact || !txtEmail) {
          const alertDiv = /*html*/ `
           <div class="alert alert-danger d-flex align-items-center p-2 my-2 mx-4" role="alert">
            <svg class="bi flex-shrink-0 me-2" width="24" height="24" role="img" aria-label="Danger:"><use xlink:href="#exclamation-triangle-fill"/>
              <symbol id="exclamation-triangle-fill" fill="currentColor" viewBox="0 0 16 16">
              <path d="M8.982 1.566a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767L8.982 1.566zM8 5c.535 0 .954.462.9.995l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 5.995A.905.905 0 0 1 8 5zm.002 6a1 1 0 1 1 0 2 1 1 0 0 1 0-2z"/>
              </symbol>
            </svg>

              <div>
                <b>이름/전화번호/이메일</b>을 <u>전부</u> 입력해주세요.
            <button type="button" class="btn-close" data-bs-dismiss="alert"
              aria-label="Close">
                    </div>
              </button>

              </div>

            `;

          formInput.insertAdjacentHTML("afterend", alertDiv);
        } else {
          let cell1 = newRow.insertCell(0); //순번
          cell1.innerHTML = "👨🏻‍💼"; //newRow + 1

          let cell2 = newRow.insertCell(1);
          cell2.innerHTML = txtName;

          let cell3 = newRow.insertCell(2);
          cell3.innerHTML = txtContact;

          let cell4 = newRow.insertCell(3);
          cell4.innerHTML = txtEmail;

          let cell5 = newRow.insertCell(4);
          cell5.innerHTML = BtnDelete;
        }
        return;
      }

      /*삭제 이벤트*/
      const BtnDelete = /*html*/ `
       <button
        type = "button"
        id="btn-del"
        class="btn_delete btn-outline-secondary text-nowrap btn-sm remove"
        onClick = "delRow()">
        삭제
       </button>
      `;
      /*
        function delRow() {
          let event = document.getElementsByClassName("btn_delete");
          for (let i = 0; i < event.length; i++) {
            event[i].addEventListener("click", function () {
              let parent = document.querySelector("#table tbody");
              parent.removeChild(this.parentElement.parentElement);
              i--;
            });
          }
        }
        */

      function delRow() {
        let event = document.getElementsByClassName("btn_delete");
        for (let i = 0; i < event.length; i++) {
          event[i].addEventListener("click", function () {
            let parent = document.querySelector("#table tbody");
            parent.removeChild(this.parentElement.parentElement);
            i--;
          });
        }
      }
    </script>
  </body>
</html>
